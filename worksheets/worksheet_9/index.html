<!DOCTYPE html>
<html>

<head>
    <title>Worksheet 9</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="Jakub Janaszkiewicz">
    <link rel="stylesheet" href="../../vendor/bootstrap/css/bootstrap.min.css">
    <style>
        table {
            table-layout: auto;
        }

        th {
            text-align: center;
            font-size: 150%;
        }
    </style>
</head>

<body>
    <table class="table">
        <thead>
            <th>Exercise</th>
            <th>Solution</th>
            <th></th>
        </thead>
        <tbody>
            <tr>
                <td>
                    <h3>Part 1</h3>
                    The scene is a teapot jumping up and down on a textured ground quad with a point light circling the
                    scene. We can set up this scene by combining Part 3 of Worksheet 5 with Part 3 of Worksheet 8.
                    The main difficulties are (a) that the ground plane and the loaded object use different shaders and
                    (b) that we need to position the teapot in the scene.
                    <br><br>
                    <ul>
                        <li>
                            Use your code from Part 3 of Worksheet 5 to load and render the
                            teapot model, which is available on File Sharing. Scale the teapot to a quarter of its
                            original size and construct a model matrix for it that translates it by the vector (0, −1,
                            −3).
                        </li>
                        <li>
                            Insert shaders and the part that initializes and draws the textured ground quad from Part 3
                            of Worksheet 8. The ground quad and the teapot use different shaders. Consult the section
                            called “Switching Shaders” from the WebGL Programming Guide to render these two objects
                            using their own shaders. It is important to note the use of the function
                            initAttributeVariable in the render function.
                        </li>
                        <li>
                            Move the teapot up and down over time by modifying the model matrix. Create a button that
                            turns this motion on/off.
                        </li>
                        <li>
                            Ensure that you can modify the view matrix. Create an extra view matrix that looks at the
                            teapot and the ground directly from above. Use this for debugging purposes, as it is much
                            easier to spot misplaced shadows in this view.
                        </li>
                        <li>
                            For reference, insert the black projection shadows from Part 3 of Worksheet 8. In this
                            scene, we use a model matrix to move the shadow-casting object. It is important to realize
                            that the model matrix should be applied first (before the shadow projection matrix) when
                            rendering the shadow polygons.
                        </li>
                        <li>
                            Set the light direction in the teapot shading according to the position of the point light
                            circling the scene. Create a button that switches point light animation on/off.
                        </li>
                    </ul>
                </td>
                <td>
                    <canvas id="canvas1" width="512" height="512">Please use a browser supporting HTML5</canvas>
                    <div>
                        <div>Bounce <input id="bounce" type="checkbox" checked /></div>
                        <div>Look down <input id="lookDown" type="checkbox" /></div>
                        <div>Move light <input id="lightMove" type="checkbox" checked /></div>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>

    <script type="text/javascript" src="../../common/webgl-utils.js"></script>
    <script type="text/javascript" src="../../common/initShaders.js"></script>
    <script type="text/javascript" src="../../common/MV.js"></script>
    <script type="text/javascript" src="../../common/OBJParser.js"></script>
    <script type="text/javascript" src="../../common/simple_camera.js"></script>


    <!-- PART 1 - GROUND -->
    <script id="vertex-shader-ground-1" type="x-shader/x-vertex">
        attribute vec3 position;
        attribute vec2 texPosition;
        
        uniform mat4 modelView;
        uniform mat4 perspective;
        
        varying vec2 fTexCoord;

        void main() {
            fTexCoord = texPosition;
            gl_Position = perspective * modelView * vec4(position, 1);
        }
    </script>
    <script id="fragment-shader-ground-1" type="x-shader/x-fragment">
        precision mediump float;
        
        varying vec2 fTexCoord;
        uniform sampler2D texture;

        void main() {
            gl_FragColor = texture2D(texture, fTexCoord);
        }
    </script>

    <!-- PART 1 - TEAPOT -->
    <script id="vertex-shader-teapot-1" type="x-shader/x-vertex">
        attribute vec3 position;
        attribute vec3 normal;
        attribute vec4 color;
        
        uniform mat4 modelView;
        uniform mat4 perspectiveMatrix;

        varying vec4 fColor;

        void main() {
            fColor = color;
            
            vec4 cameraPos = modelView * vec4(position, 1);
            gl_Position = perspectiveMatrix * cameraPos;
        }
    </script>
    <script id="fragment-shader-teapot-1" type="x-shader/x-fragment">
        precision highp float;
        
        varying vec4 fColor;
        uniform bool visible;

        void main() {
            if (visible) {
                gl_FragColor = vec4(1, 0, 0, 1);
            } else {
                gl_FragColor = vec4(0, 0, 0, 1);
            }
        }
    </script>
    <script type="text/javascript" src="./script1.js"></script>
</body>

</html>